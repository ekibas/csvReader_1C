# CSV reader

*Внешняя компонента с использованием технологии COM, для парсинга .csv файла (файла с разделителем) и сбора из данных файла сериализованной в строку таблицы значений (в 1С:Предприятие десериализация происходит методом ЗначениеИзСтрокиВнутр(Текст)).*

* **Важно!** Пример написан для файловой базы, вариант клиент-серверного взаимодействия необходимо обдумать самостоятельно!
* **Важно!** Компонета написанная по технологии Com работает только под клиентом

#### Методы компоненты:
 
```CreateHeader(string[] saTypes, string[] saNames)``` - подготавливает описание сериализованной таблицы.  
* ```saTypes``` - массив типов колонок (поддерживает S-строка, D-дата,время, B-булево, N- числовой тип)  
* ```saNames``` - имена колонок    

```ReflectCSVtoTable(string[] saFiles, string sPathTmp, string sFieldDelim, bool skipHeader)``` - чтение файла .csv в подготовленную таблицу методом (CreateHeader)
 * ```saFiles```     - массив .csv файлов
 * ```sPathTmp```    - путь к сериализованной таблице значений
 * ```sFieldDelim``` - разделитель 
 * ```skipHeader```  - пропускать первую строку (является ли первая строка заголовком)  

 ```EnableDebugMode(Boolean bDebugMode)``` - включить режим отладки, иначе логируются только исключения

#### Регистрация компоненты
* Cтрока регистрации компоненты: ```RegAsm.exe CSVWorker.dll /codebase /tlb: CSVWorker.tlb``` 
